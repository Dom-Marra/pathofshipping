<div matAutocompleteOrigin #autoCompleteHost="matAutocompleteOrigin" class="stat-select">

    <div class="stat-selector">
        <button *ngIf="statSelected" class="remove-stat-button" (click)="deleteStatFilter()" mat-flat-button><mat-icon class="stat-icon">remove</mat-icon></button>
        <mat-form-field floatLabel="never">
            <mat-label *ngIf="!selectedStat">Add Stat Filter</mat-label>
            <input #statInput matInput type="text" autocomplete="off" 
                [matAutocomplete]="searchableStats" 
                [matAutocompleteConnectedTo]="autoCompleteHost"
                [placeholder]="selectedStat?.text"
                (input)="filteredStats = filterStats($event.target.value)"
                [value]="selectedStat?.text"
                (focus)="$event.target.value = ''; filteredStats = filterStats('')"
                (blur)="$event.target.value = selectedStat?.text">
                
            <mat-icon matSuffix class="icon-dark" [class.rotate]="searchableStats.isOpen">arrow_drop_down</mat-icon>
            <mat-autocomplete #searchableStats="matAutocomplete" 
                            [class]="'autocomplete-panel'"
                            autoActiveFirstOption="'true'"
                            (optionSelected)="selectedStat = $event.option.value; setStat(); 
                                            statGroup.controls.id.patchValue($event.option.value.id); statInput.blur();">
                <mat-optgroup *ngFor="let search of filteredStats" [label]="search.category">
                    <mat-option *ngFor="let item of search.stats | slice:0:25;" [value]="item">
                        {{item.text}}
                    </mat-option>
                </mat-optgroup>
            </mat-autocomplete>
        </mat-form-field>
    </div>
    

    <div *ngIf="statSelected && selectedStat.option == null" class="stat-min-max-fields">
        <mat-form-field>
            <mat-label>Min</mat-label>
            <input digitsonly matInput type="text" autocomplete="off" [formControl]="statGroup.get('value.min')">
        </mat-form-field>
        <mat-form-field>
            <mat-label>Max</mat-label>
            <input digitsonly matInput type="text" autocomplete="off" [formControl]="statGroup.get('value.max')">
        </mat-form-field>
    </div>

    <div *ngIf="statSelected && selectedStat.option != null" class="stat-option-select">
        <mat-form-field floatLabel='never'>
            <mat-label *ngIf="!selectedStatOption">Select Option</mat-label>
            <input #statOptionInput matInput type="text"  autocomplete="off" 
                    [matAutocomplete]="searchableStatOptions" 
                    [matAutocompleteConnectedTo]="autoCompleteHost"
                    [placeholder]="selectedStatOption?.text"
                    (input)="filteredStatOptions = filterStatOptions($event.target.value)"
                    [value]="selectedStatOption?.text"
                    (focus)="$event.target.value = ''; filteredStatOptions = filterStatOptions('')"
                    (blur)="$event.target.value = selectedStatOption?.text">
    
            <mat-icon matSuffix class="icon-dark" [class.rotate]="searchableStatOptions.isOpen">arrow_drop_down</mat-icon>
            <mat-autocomplete #searchableStatOptions="matAutocomplete" 
                            [class]="'autocomplete-panel'" 
                            autoActiveFirstOption="'true'"
                            (optionSelected)="this.statGroup.get('value.option').patchValue($event.option.value.id); 
                                            statOptionInput.blur(); this.selectedStatOption = $event.option.value">
                <mat-option *ngFor="let option of filteredStatOptions" [value]="option">
                    {{option.text}}
                </mat-option>
            </mat-autocomplete>
        </mat-form-field>
    </div>
<div>
